# Custom J316 Audio Graph Override
# This replaces the default Asahi audio DSP chain with a simplified version
# that removes the problematic Bankstown bass enhancement and aggressive
# multiband compression that cause crackling on transients.
#
# What's removed:
# - Bankstown bass enhancement (naive algorithm causing crackling)
# - Multiband woofer compressor (too aggressive on transients)
#
# What's kept:
# - Loudness compensation (equal loudness curve)
# - Convolvers for tweeters/woofers (speaker protection & EQ)
# - Gentle limiter (smooth compression instead of aggressive multiband)
#
# To revert to stock Asahi audio, remove this file and restart WirePlumber.

node.software-dsp.rules = [
    # J316 (MacBook Pro 16", M1 Pro/Max, 2021) - Custom Simplified Graph
    {
        matches = [
            { api.alsa.path = "hw:AppleJ316,1" }
        ]
        actions = {
            create-filter = {
                filter-path = "~/.local/share/asahi-audio-custom/j316/graph-simplified.json"
                hide-parent = true
            }
        }
    }
]
