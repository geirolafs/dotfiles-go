# PipeWire Quantum (Buffer Size) Configuration
# Reduces audio latency to fix crackling/popping during playback start/stop
#
# Background:
# The Asahi audio DSP chain has known buffering issues causing "trailing audio"
# and crackling when switching between sources. Reducing quantum from the default
# 1024 frames helps minimize these artifacts.
#
# Quantum settings:
# - 1024 frames @ 48kHz = ~21ms latency (Asahi default, can cause crackling)
# - 512 frames @ 48kHz = ~10.6ms latency (good balance)
# - 256 frames @ 48kHz = ~5.3ms latency (lower latency)
# - 128 frames @ 48kHz = ~2.7ms latency (lowest, for casual listening)
#
# Set to 256 for better balance between latency and stability when using EQ.
# Lower quantum (128) can cause crackling with aggressive EQ processing.
# M1 Max has plenty of CPU headroom for this setting.

context.properties = {
    # Set default quantum to 256 frames for balance
    # Optimized for EQ processing without crackling (~5.3ms latency)
    default.clock.quantum = 256

    # Allow range from 128 to 2048 for flexibility
    default.clock.min-quantum = 128
    default.clock.max-quantum = 2048
}
